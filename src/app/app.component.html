<div style="padding: 20px;">
  <h2>Pager Duty Schedules</h2>

  <div>
    <label for="token">Token:</label>
    <input type="password" id="token" [(ngModel)]="token" placeholder="Enter Token" />
  </div>

  <div>
    <label for="primaryId">Primary Schedule ID:</label>
    <input type="text" id="primaryId" [(ngModel)]="primaryId" placeholder="Enter Primary Schedule ID" />
  </div>

  <div>
    <label for="secondaryId">Secondary Schedule ID:</label>
    <input type="text" id="secondaryId" [(ngModel)]="secondaryId" placeholder="Enter Secondary Schedule ID" />
  </div>

  <div>
    <label for="fromDate">From Date:</label>
    <input type="datetime-local" id="fromDate" [(ngModel)]="fromDate" />
  </div>

  <div>
    <label for="toDate">To Date:</label>
    <input type="datetime-local" id="toDate" [(ngModel)]="toDate" />
  </div>

  <button (click)="getSchedules()">Get Schedules</button>

  <div *ngIf="isLoading">Loading...</div>

  <div *ngIf="primarySchedules">
    <h3>Primary Schedule</h3>
    <table>
      <thead>
        <tr>
          <th>Start Time</th>
          <th>End Time</th>
          <th>User</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let schedule of primarySchedules">
          <td>{{ schedule.start }}</td>
          <td>{{ schedule.end }}</td>
          <td>{{ schedule.user.summary }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="secondarySchedules">
    <h3>Secondary Schedule</h3>
    <table>
      <thead>
        <tr>
          <th>Start Time</th>
          <th>End Time</th>
          <th>User</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let schedule of secondarySchedules">
          <td>{{ schedule.start }}</td>
          <td>{{ schedule.end }}</td>
          <td>{{ schedule.user.summary }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <button *ngIf="primarySchedules || secondarySchedules" (click)="exportToExcel()">Export to Excel</button>
</div>
